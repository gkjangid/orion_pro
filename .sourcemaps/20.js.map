{"version":3,"sources":["../../src/pages/activity-info/activity-info.module.ts","../../src/pages/activity-info/activity-info.ts"],"names":[],"mappings":"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","file":"20.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule }    from 'ionic-angular';\nimport { ActivityInfoPage }   from './activity-info';\nimport { ComponentsModule }   from '../../components/components.module';\n\n@NgModule({\n  declarations: [\n    ActivityInfoPage,\n  ],\n  imports: [\n    ComponentsModule,\n    IonicPageModule.forChild(ActivityInfoPage),\n  ],\n})\nexport class ActivityInfoPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/activity-info/activity-info.module.ts","import { Component, OnInit } from '@angular/core';\nimport { Events, IonicPage, NavController, NavParams } from 'ionic-angular';\nimport { ApiProvider }  from '../../providers/api/api';\n\n\n@IonicPage({ segment: 'activity-info/:id' })\n@Component({\n  selector: 'page-activity-info',\n  templateUrl: 'activity-info.html',\n})\nexport class ActivityInfoPage implements OnInit {\n\n  activity:           any = {};\n  activityId:         number;\n  enrolled:           number[];\n  enrollBtnDisabled:  boolean = null;\n\n  constructor(\n    private api:        ApiProvider,\n    private events:     Events,\n    private navCtrl:    NavController,\n    private navParams:  NavParams,\n  ) { }\n\n  ngOnInit(){\n    this.events.subscribe( 'login', user => {\n      if ( !this.activityId ){ return; }\n      this.getActivity( this.activityId );\n    });\n  }\n\n  checkEnrollment( activity: any, enrolled: number[] ): boolean {\n    return enrolled.indexOf( activity.id ) != -1\n  }\n\n  enroll(): void {\n    if( !this.api.user.userId ){\n      console.error( 'Unknown user' );\n      alert( 'Unknown user' );\n      return;\n    }\n    this.api.enrollActivity( this.activity )\n      .subscribe( response => {\n        let msg;\n        if ( response.data.enrolled ){\n          this.navCtrl.popToRoot();\n          msg = `'${this.activity.title}' added to your activity list`;\n        } else {\n          msg = `'${this.activity.title}' is already in your activity list`;\n        }\n        const toast = this.api.toast({\n          message:  msg,\n          duration: 4000,\n          position: 'middle',\n        });\n        toast.present();\n      });\n  }\n\n  getActivity( activityId: number ): void {\n    this.api.getActivity( activityId )\n      .subscribe( data => {\n        this.activity = data.data;\n        this.enrollBtnDisabled = this.checkEnrollment( this.activity, this.enrolled ) || null;\n      });\n  }\n\n  getMultiData( activity: any, field: string ): string {\n    if ( !activity || !activity.questions ){\n      return '';\n    }\n    let values: any = [];\n    activity.questions.map( question => {\n      let value = question[ field ];\n      if ( !value ){ return; }\n      if ( !(value instanceof Array) ){\n        value = [value];\n      }\n      values.push( ...value );\n    });\n    values = Array.from( new Set( values ) );\n    return values.join( ', ' );\n  }\n\n  getlist( field: string ): string {\n    if ( !this.activity ) { return ''; }\n    let data = this.activity[ field ];\n    if ( !data ) { return ''; }\n    data = Array.from( new Set(\n      data.filter( x => !!x )\n    ))\n    return data.join(', ');\n  }\n\n  getSkill(): string {\n    return this.getMultiData( this.activity, 'skill' );\n  }\n\n  getSubjects(): string {\n    return this.getMultiData( this.activity, 'subjects' );\n  }\n\n  invite(): void {\n    this.navCtrl.push( 'InvitePage', { activity: this.activity } )\n  }\n\n  ionViewDidEnter(){\n    if ( !this.api.user.userId ){\n      this.navCtrl.push( 'LoginPage' );\n      return;\n    }\n    this.activityId = this.navParams.get( 'id' );\n    if ( !this.activityId ) {\n      this.navCtrl.setRoot( 'HomePage' );\n      return;\n    }\n    this.enrolled = this.navParams.get( 'enrolled' ) || [];\n    this.getActivity( this.activityId );\n  }\n\n  send(): string {\n    if ( !this.activity ) { return ''; }\n    const url        = window.location.href.split('#')[0];\n    const activityId = window.location.href.split('/').pop();\n    const title      = this.activity.title;\n    const subject    = encodeURIComponent( title );\n    const body       = encodeURIComponent(\n      `${url}#/activity-info/${activityId}`\n    );\n    return `mailto:?subject=${subject}&body=${body}`;\n  }\n\n  showButtonIf( group: string ): boolean {\n    return this.api.user.groups.indexOf( group ) != -1;\n  }\n\n  showToolbar(): boolean {\n    if ( !this.activity ) { return; }\n    return (\n      this.activity.status == \"Published\"\n      || this.api.user.groups.indexOf( 'KCT-Previewer' ) != -1\n    );\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/activity-info/activity-info.ts"],"sourceRoot":""}
{"version":3,"sources":["../../src/pages/invite/invite.module.ts","../../src/pages/invite/invite.ts"],"names":[],"mappings":"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","file":"12.js","sourcesContent":["import { NgModule }         from '@angular/core';\nimport { IonicPageModule }  from 'ionic-angular';\nimport { InvitePage }       from './invite';\nimport { ComponentsModule } from '../../components/components.module';\n\n\n@NgModule({\n  declarations: [\n    InvitePage,\n  ],\n  imports: [\n    IonicPageModule.forChild(InvitePage),\n    ComponentsModule,\n  ],\n})\nexport class InvitePageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/invite/invite.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams } from 'ionic-angular';\nimport { ApiProvider } from '../../providers/api/api';\n\n\n@IonicPage()\n@Component({\n  selector:    'page-invite',\n  templateUrl: 'invite.html',\n})\nexport class InvitePage {\n\n  activity:     any     = {};\n  deadline:     Date    = null;\n  groups:       any[]   = [];\n  individuals:  any[]   = [];\n  minYear:      number  = new Date().getFullYear();\n  maxYear:      number  = this.minYear + 2;\n  segment:      string  = 'groups';\n  showSpinner:  boolean = false;\n  startDate:    Date    = null;\n\n  constructor(\n    public api:       ApiProvider,\n    public navCtrl:   NavController,\n    public navParams: NavParams,\n  ){}\n\n  alertInviteErrors( errors ): void {\n    this.api.utils.alertCtrl.create({\n      subTitle: 'The following have already enrolled.  No Invitations were sent to them.',\n      message: errors.join( '\\n' ),\n      enableBackdropDismiss: false,\n      buttons: [\n        {\n          text: 'OK',\n          handler: () => {\n            this.navCtrl.pop();\n          }\n        },\n      ],\n    }).present();\n  }\n\n  getGroupName( name: string ): string {\n    return name.split( '-' ).slice( 1 ).join( '-' ).trim();\n  }\n\n  getGroups( data ): any[] {\n    return data.filter( item => item.name.startsWith( 'PVT-' ) );\n  }\n\n  getIndividuals( groups: any[] ): any[] {\n    let individuals = {};\n    groups.map( group => {\n      group.users.map( user => {\n        individuals [user.username] = user;\n      });\n    });\n    return Object.keys( individuals ).sort().map( item => {\n      return individuals [item];\n    });\n  }\n\n  ionViewDidEnter(): void {\n    this.activity = this.navParams.get( 'activity' );\n    this.api.getMyGroupsWithUsers()\n      .subscribe( data => {\n        this.groups = this.getGroups( data );\n        this.individuals = this.getIndividuals( this.groups );\n      });\n  }\n\n  invite(): void {\n    this.showSpinner = true;\n    let data = {\n      activityId: this.activity.id,\n\n      groups: this.groups\n        .filter( item => item.selected )\n        .map( item => item.name ),\n\n      individuals:this.individuals\n        .filter( item => item.selected )\n        .map( item => item.username ),\n\n      startDate: this.startDate,\n      deadline:  this.deadline,\n      };\n    if ( data.groups.length || data.individuals.length ){\n      this.api.sendInvitations( data ).subscribe( response => {\n        this.showSpinner = false;\n        this.api.refreshData();\n\n        let errors = response.data;\n        if ( errors.length ){\n          this.alertInviteErrors( errors );\n        } else {\n          this.navCtrl.pop();\n        }\n      });\n    } else {\n      this.showSpinner = false;\n    }\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/invite/invite.ts"],"sourceRoot":""}